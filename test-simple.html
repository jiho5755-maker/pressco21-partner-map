<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°„ë‹¨ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #f5f5f5;
        }
        .log {
            background: white;
            padding: 10px;
            margin: 5px 0;
            border-left: 3px solid #4CAF50;
        }
        .error {
            border-left-color: #f44336;
            color: #f44336;
        }
    </style>
</head>
<body>
    <h1>íŒŒíŠ¸ë„ˆë§µ v3 - ê°„ë‹¨ í…ŒìŠ¤íŠ¸</h1>
    <div id="output"></div>

    <script src="/js/config.js"></script>
    <script src="/js/api.js"></script>

    <script>
        var output = document.getElementById('output');

        function log(msg, isError) {
            var div = document.createElement('div');
            div.className = 'log' + (isError ? ' error' : '');
            div.textContent = msg;
            output.appendChild(div);
            console.log(msg);
        }

        log('1. CONFIG ë¡œë“œ í™•ì¸...');
        log('   useTestData: ' + (window.CONFIG ? window.CONFIG.useTestData : 'CONFIG ì—†ìŒ'));
        log('   testDataPath: ' + (window.CONFIG ? window.CONFIG.testDataPath : 'CONFIG ì—†ìŒ'));

        log('2. PartnerAPI ìƒì„±...');
        try {
            var api = new window.PartnerAPI(window.CONFIG);
            log('   âœ… PartnerAPI ìƒì„± ì„±ê³µ');
        } catch (e) {
            log('   âŒ PartnerAPI ìƒì„± ì‹¤íŒ¨: ' + e.message, true);
        }

        log('3. ë°ì´í„° ë¡œë“œ ì‹œì‘...');
        api.loadPartnerData(true).then(function(partners) {
            log('   âœ… ë°ì´í„° ë¡œë“œ ì„±ê³µ: ' + partners.length + 'ê°œ');

            if (partners.length > 0) {
                var p = partners[0];
                log('4. ì²« ë²ˆì§¸ íŒŒíŠ¸ë„ˆ ë°ì´í„°:');
                log('   ID: ' + p.id);
                log('   ì´ë¦„: ' + p.name);
                log('   latitude: ' + p.latitude + ' (í•„ë“œ ì¡´ì¬: ' + ('latitude' in p) + ')');
                log('   longitude: ' + p.longitude + ' (í•„ë“œ ì¡´ì¬: ' + ('longitude' in p) + ')');
                log('   ì£¼ì†Œ: ' + p.address);
                log('   ì¹´í…Œê³ ë¦¬: ' + (Array.isArray(p.category) ? p.category.join(', ') : p.category));
            }

            log('');
            log('ğŸ‰ í…ŒìŠ¤íŠ¸ ì™„ë£Œ! ëª¨ë“  íŒŒíŠ¸ë„ˆ ë°ì´í„°:');
            log('ì´ ' + partners.length + 'ê°œ íŒŒíŠ¸ë„ˆ');

            // ì§€ì—­ë³„ ë¶„í¬
            var regions = {};
            partners.forEach(function(p) {
                var region = p.address.split(' ')[0].replace('íŠ¹ë³„ì‹œ', '').replace('ê´‘ì—­ì‹œ', '');
                regions[region] = (regions[region] || 0) + 1;
            });

            log('');
            log('ì§€ì—­ë³„ ë¶„í¬:');
            Object.keys(regions).sort().forEach(function(r) {
                log('  ' + r + ': ' + regions[r] + 'ê°œ');
            });

        }).catch(function(error) {
            log('   âŒ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ' + error.message, true);
            console.error(error);
        });
    </script>
</body>
</html>
